// Replace with your email address
const RECIPIENT_EMAIL = "example@example.com";

function onFormSubmit(e) {
  if (!e || !e.response) {
    Logger.log("No response data found.");
    return;
  }

  // Get the form and its name
  const form = FormApp.getActiveForm();
  const formName = form.getTitle();

  // Get the response data from the event object
  const response = e.response;
  const items = form.getItems();

  // Build the email content as HTML
  let emailBody = `<h2>New Response from "${formName}"</h2><table border='1' style='border-collapse:collapse;'>`;

  items.forEach((item) => {
    const question = item.getTitle(); // Get the question title
    const responseItem = response.getResponseForItem(item);

    // Handle null responses
    const responseText = responseItem ? responseItem.getResponse() : "No response";

    // Add question and response as a table row
    emailBody += `
      <tr>
        <td style="padding:8px;"><strong>${question}</strong></td>
        <td style="padding:8px;">${responseText}</td>
      </tr>`;
  });

  emailBody += "</table>";

  // Send the email with the form name in the subject
  GmailApp.sendEmail(RECIPIENT_EMAIL, `New Response from "${formName}"`, "", {
    htmlBody: emailBody,
  });
}

// Installable trigger setup function
function setupTrigger() {
  const form = FormApp.getActiveForm();
  ScriptApp.newTrigger("onFormSubmit")
    .forForm(form)
    .onFormSubmit()
    .create();
}
