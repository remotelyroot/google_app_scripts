// Replace with your email address
const RECIPIENT_EMAIL = "example@example.com";

function onFormSubmit(e) {
  if (!e || !e.response) {
    Logger.log("No response data found.");
    return;
  }

  // Get the response data from the event object
  const response = e.response;

  // Get the form and questions
  const form = FormApp.getActiveForm();
  const items = form.getItems();

  // Build the email content
  let emailBody = "New Google Form Response:\n\n";

  items.forEach((item) => {
    const question = item.getTitle(); // Get the question title
    const responseItem = response.getResponseForItem(item);

    // Handle null responses
    const responseText = responseItem ? responseItem.getResponse() : "No response";
    emailBody += `Question: ${question}\nResponse: ${responseText}\n\n`;
  });

  // Send the email
  GmailApp.sendEmail(RECIPIENT_EMAIL, "New Google Form Response", emailBody);
}

// Installable trigger setup function
function setupTrigger() {
  const form = FormApp.getActiveForm();
  ScriptApp.newTrigger("onFormSubmit")
    .forForm(form)
    .onFormSubmit()
    .create();
}
